\doxysection{Thresholds\+Controller.\+h}
\hypertarget{_thresholds_controller_8h_source}{}\label{_thresholds_controller_8h_source}\index{PF-\/Edge/include/ThresholdsController.h@{PF-\/Edge/include/ThresholdsController.h}}
\mbox{\hyperlink{_thresholds_controller_8h}{Ir a la documentación de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#ifndef\ THRESHOLDS\_CONTROLLER\_H}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ THRESHOLDS\_CONTROLLER\_H}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{comment}{//\ Librerías}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{data_sensor_8h}{dataSensor.h}}"{}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_p_f-_edge_2include_2data_actuator_8h}{dataActuator.h}}"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <Arduino.h>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00021\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_thresholds_a30c6e93bdc6fd6240f479ab39b78edf8}{Thresholds}}\ \{}
\DoxyCodeLine{00022\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{keywordtype}{float}\ minSoilMoisture\ =\ 45.0;\ }
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keywordtype}{float}\ maxSoilMoisture\ =\ 70.0;\ }
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keywordtype}{float}\ minTemperature\ =\ 24.0;\ }
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keywordtype}{float}\ maxTemperature\ =\ 28.0;\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordtype}{float}\ maxCO2\ =\ 800.0;\ }
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{int}\ minLight\ =\ 300;\ }
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keywordtype}{float}\ minVoltage\ =\ 6.0;\ }
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keywordtype}{int}\ minRSSI\ =\ -\/70;\ }
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{class_thresholds_a30c6e93bdc6fd6240f479ab39b78edf8}{Thresholds}}()\ \{\}}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{comment}{//\ RSSI\ Sensor\ y\ WiFi}}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_thresholds_a90fd4587dea399f567a7c5402be09da7}{RSSIWiFi}}\ =\ 0;\ }
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{comment}{//\ Alert\ flags}}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordtype}{bool}\ alertLowSoilMoisture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{bool}\ alertHighSoilMoisture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordtype}{bool}\ alertLowTemperature\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordtype}{bool}\ alertHighTemperature\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keywordtype}{bool}\ alertCO2\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{bool}\ alertLight\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keywordtype}{bool}\ alertVoltage\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordtype}{bool}\ alertESPSensor\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordtype}{bool}\ alertESPActuator\ =\ \textcolor{keyword}{false};\ }
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordtype}{bool}\ alertWifi\ =\ \textcolor{keyword}{false};\ }
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{comment}{//\ Guarda\ los\ valores\ anteriores\ de\ los\ flags\ de\ alerta}}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keywordtype}{bool}\ prevAlertLowSoilMoisture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keywordtype}{bool}\ prevAlertHighSoilMoisture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordtype}{bool}\ prevAlertLowTemperature\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordtype}{bool}\ prevAlertHighTemperature\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{bool}\ prevAlertCO2\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordtype}{bool}\ prevAlertLight\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordtype}{bool}\ prevAlertVoltage\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordtype}{bool}\ prevAlertESPSensor\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{bool}\ prevAlertESPActuator\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordtype}{bool}\ prevAlertWifi\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_thresholds_a598f35abd225b482dc1edbbeb2ebc0be}{hasAlertChanged}}()\ \{}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ changed\ =\ }
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ (alertLowSoilMoisture\ !=\ prevAlertLowSoilMoisture)\ ||}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ (alertHighSoilMoisture\ !=\ prevAlertHighSoilMoisture)\ ||}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ (alertLowTemperature\ !=\ prevAlertLowTemperature)\ ||}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ (alertHighTemperature\ !=\ prevAlertHighTemperature)\ ||}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ (alertCO2\ !=\ prevAlertCO2)\ ||}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ (alertLight\ !=\ prevAlertLight)\ ||}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ (alertVoltage\ !=\ prevAlertVoltage)\ ||}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ (alertESPSensor\ !=\ prevAlertESPSensor)\ ||}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ (alertESPActuator\ !=\ prevAlertESPActuator)\ ||}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ (alertWifi\ !=\ prevAlertWifi);}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Actualiza\ los\ valores\ previos}}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ prevAlertLowSoilMoisture\ =\ alertLowSoilMoisture;}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ prevAlertHighSoilMoisture\ =\ alertHighSoilMoisture;}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ prevAlertLowTemperature\ =\ alertLowTemperature;}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ prevAlertHighTemperature\ =\ alertHighTemperature;}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ prevAlertCO2\ =\ alertCO2;}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ prevAlertLight\ =\ alertLight;}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ prevAlertVoltage\ =\ alertVoltage;}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ prevAlertESPSensor\ =\ alertESPSensor;}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ prevAlertESPActuator\ =\ alertESPActuator;}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ prevAlertWifi\ =\ alertWifi;}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ changed;}
\DoxyCodeLine{00094\ \ \ \ \ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_thresholds_acbe4c91c942cefda9895d31ffb76727f}{anySensorAlertActive}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ alertLowSoilMoisture\ ||}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alertHighSoilMoisture\ ||}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alertLowTemperature\ ||}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alertHighTemperature\ ||}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alertCO2\ ||}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alertLight\ ||}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alertVoltage;}
\DoxyCodeLine{00108\ \ \ \ \ \}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_thresholds_a592d9bd4c8ef0344796b75cdf72efdf8}{hasCriticalFailure}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Considera\ fallo\ crítico\ si\ hay\ pérdida\ de\ conexión\ con\ nodos\ o\ voltaje\ bajo}}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ alertESPSensor\ ||\ alertESPActuator\ ||\ alertVoltage;}
\DoxyCodeLine{00120\ \ \ \ \ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00130\ \ \ \ \ \mbox{\hyperlink{struct_actuator_state}{ActuatorState}}\ \mbox{\hyperlink{class_thresholds_a3bb92d66f2bf1123cd1e4541241fd81b}{evaluate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_sensor_data}{SensorData}}\&\ data)\ \{}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_actuator_state}{ActuatorState}}\ state;}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ state.\mbox{\hyperlink{struct_actuator_state_a2e6e71e1b72f5f7df11eb03a1b48b99e}{waterPump}}\ =\ 0;}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ state.\mbox{\hyperlink{struct_actuator_state_a1cfe9ff4489556ce5b58d5a30a42f1ca}{fan}}\ =\ 0;}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ state.\mbox{\hyperlink{struct_actuator_state_ab1f44635e84e731fcc0aae40c678a9ef}{leds}}\ =\ 0;}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Evaluar\ humedad\ del\ suelo}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (data.soilMoisture\ <\ minSoilMoisture)\ \{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ state.\mbox{\hyperlink{struct_actuator_state_a2e6e71e1b72f5f7df11eb03a1b48b99e}{waterPump}}\ =\ 1;}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ alertLowSoilMoisture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ }
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ alertLowSoilMoisture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (data.soilMoisture\ >\ maxSoilMoisture)\ \{}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ alertHighSoilMoisture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ alertHighSoilMoisture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Evaluar\ temperatura}}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (data.temperature\ <\ minTemperature)\ \{}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ alertLowTemperature\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ alertLowTemperature\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (data.temperature\ >\ maxTemperature)\ \{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ alertHighTemperature\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ state.\mbox{\hyperlink{struct_actuator_state_a1cfe9ff4489556ce5b58d5a30a42f1ca}{fan}}\ =\ 1;}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ alertHighTemperature\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Evaluar\ CO2}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (data.co2ppm\ >\ maxCO2)\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ alertCO2\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ state.\mbox{\hyperlink{struct_actuator_state_a1cfe9ff4489556ce5b58d5a30a42f1ca}{fan}}\ =\ 1;}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ alertCO2\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Evaluar\ luz}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (data.light\ <\ minLight)\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ alertLight\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ state.\mbox{\hyperlink{struct_actuator_state_ab1f44635e84e731fcc0aae40c678a9ef}{leds}}\ =\ 1;}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ alertLight\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Evaluar\ voltaje}}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (data.voltage\ <\ minVoltage)\ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ alertVoltage\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ alertVoltage\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ state;}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Evaluar\ conexión\ wiFi\ (opcional)}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_thresholds_a90fd4587dea399f567a7c5402be09da7}{RSSIWiFi}}\ <\ minRSSI)\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ alertWifi\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ alertWifi\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00194\ \ \ \ \ \}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00204\ \ \ \ \ String\ \mbox{\hyperlink{class_thresholds_a8465e30d67052905f53b748e46f5749c}{returnAlarm}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_sensor_data}{SensorData}}\&\ data)\ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ String\ msg\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_thresholds_a592d9bd4c8ef0344796b75cdf72efdf8}{hasCriticalFailure}}())\ \{}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🚨\ ALERTA\ CRÍTICA\ DETECTADA:\(\backslash\)n"{}};}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alertESPSensor)\ \{}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}⚠️\ Conexión\ Nodo\ Sensores\ perdida.\(\backslash\)n"{}};}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🔍\ Revisa\ el\ sensor\ o\ reinicia\ el\ dispositivo.\(\backslash\)n"{}};}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alertESPActuator)\ \{}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}⚠️\ Conexión\ Nodo\ Actuadores\ perdida.\(\backslash\)n"{}};}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🔍\ Revisa\ el\ actuador\ o\ reinicia\ el\ dispositivo.\(\backslash\)n"{}};}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alertVoltage)\ \{}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}⚠️\ Voltaje\ bajo\ ("{}}\ +\ String(data.voltage,\ 2)\ +\ \textcolor{stringliteral}{"{}\ V).\(\backslash\)n"{}};}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🔍\ Revisa\ la\ fuente\ de\ alimentación.\(\backslash\)n"{}};}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_thresholds_acbe4c91c942cefda9895d31ffb76727f}{anySensorAlertActive}}())\ \{}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}ALERTAS\ DE\ SENSORES:\(\backslash\)n"{}};}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alertLowSoilMoisture)\ \{}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🌱\ Humedad\ del\ suelo\ baja\ ("{}}\ +\ String(data.soilMoisture,\ 1)\ +\ \textcolor{stringliteral}{"{}\%).\(\backslash\)n"{}};}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🔁\ Activando\ bomba\ de\ agua.\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alertHighSoilMoisture)\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🌱\ Humedad\ del\ suelo\ alta\ ("{}}\ +\ String(data.soilMoisture,\ 1)\ +\ \textcolor{stringliteral}{"{}\%).\(\backslash\)n"{}};}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🔍\ Revisa\ el\ drenaje.\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alertLowTemperature)\ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🌡️\ Temperatura\ baja\ ("{}}\ +\ String(data.temperature,\ 1)\ +\ \textcolor{stringliteral}{"{}°C).\(\backslash\)n"{}};}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🔍\ Revisa\ el\ calentador.\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alertHighTemperature)\ \{}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🌡️\ Temperatura\ alta\ ("{}}\ +\ String(data.temperature,\ 1)\ +\ \textcolor{stringliteral}{"{}°C).\(\backslash\)n"{}};}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🔁\ Activando\ ventilador.\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alertCO2)\ \{}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🫁\ CO2\ alto\ ("{}}\ +\ String(data.co2ppm)\ +\ \textcolor{stringliteral}{"{}\ ppm).\(\backslash\)n"{}};}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🔁\ Activando\ ventilador.\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alertLight)\ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}💡\ Luz\ insuficiente\ ("{}}\ +\ String(data.light)\ +\ \textcolor{stringliteral}{"{}).\(\backslash\)n"{}};}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🔁\ Encendiendo\ LEDs.\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alertWifi)\ \{}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}📶\ Conexión\ WiFi\ débil\ ("{}}\ +\ String(\mbox{\hyperlink{class_thresholds_a90fd4587dea399f567a7c5402be09da7}{RSSIWiFi}})\ +\ \textcolor{stringliteral}{"{}\ dBm).\(\backslash\)n"{}};}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🔍\ Revisa\ la\ conexión\ WiFi.\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ msg;\ \textcolor{comment}{//\ Si\ está\ vacío,\ todo\ está\ normal}}
\DoxyCodeLine{00264\ \ \ \ \ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00270\ \ \ \ \ String\ \mbox{\hyperlink{class_thresholds_a06485a2d2379ccefed776cf2e3694c25}{getStatus}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ String\ status\ =\ \textcolor{stringliteral}{"{}📐\ Umbrales\ actuales:\(\backslash\)n"{}};}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ status\ +=\ \textcolor{stringliteral}{"{}🌱\ Hum.\ Suelo:\ "{}}\ +\ String(minSoilMoisture)\ +\ \textcolor{stringliteral}{"{}\ \%\ -\/\ "{}}\ +\ String(maxSoilMoisture)\ +\ \textcolor{stringliteral}{"{}\ \%\(\backslash\)n"{}};}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ status\ +=\ \textcolor{stringliteral}{"{}🌡️\ Temp.:\ "{}}\ +\ String(minTemperature)\ +\ \textcolor{stringliteral}{"{}\ °C\ -\/\ "{}}\ +\ String(maxTemperature)\ +\ \textcolor{stringliteral}{"{}\ °C\(\backslash\)n"{}};}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ status\ +=\ \textcolor{stringliteral}{"{}🫁\ CO2\ <\ "{}}\ +\ String(maxCO2)\ +\ \textcolor{stringliteral}{"{}\ ppm\(\backslash\)n"{}};}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ status\ +=\ \textcolor{stringliteral}{"{}💡\ Luz\ >\ "{}}\ +\ String(minLight)\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ status\ +=\ \textcolor{stringliteral}{"{}🔋\ Voltaje\ >\ "{}}\ +\ String(minVoltage)\ +\ \textcolor{stringliteral}{"{}\ V\(\backslash\)n"{}};}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ status\ +=\ \textcolor{stringliteral}{"{}📶\ RSSI\ >\ "{}}\ +\ String(minRSSI)\ +\ \textcolor{stringliteral}{"{}\ dBm\(\backslash\)n"{}};}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ status;}
\DoxyCodeLine{00279\ \ \ \ \ \}}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_thresholds_a5826df94b84314fac5d1db2c01cef61a}{updateFromCommand}}(\textcolor{keyword}{const}\ String\&\ cmd)\ \{}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ firstSpace\ =\ cmd.indexOf(\textcolor{charliteral}{'\ '});}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ secondSpace\ =\ cmd.indexOf(\textcolor{charliteral}{'\ '},\ firstSpace\ +\ 1);}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (firstSpace\ ==\ -\/1\ ||\ secondSpace\ ==\ -\/1)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ String\ tipo\ =\ cmd.substring(firstSpace\ +\ 1,\ secondSpace);}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ valor\ =\ cmd.substring(secondSpace\ +\ 1).toFloat();}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tipo\ ==\ \textcolor{stringliteral}{"{}suelo\_min"{}})\ minSoilMoisture\ =\ valor;}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tipo\ ==\ \textcolor{stringliteral}{"{}suelo\_max"{}})\ maxSoilMoisture\ =\ valor;}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tipo\ ==\ \textcolor{stringliteral}{"{}temp\_min"{}})\ minTemperature\ =\ valor;}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tipo\ ==\ \textcolor{stringliteral}{"{}temp\_max"{}})\ maxTemperature\ =\ valor;}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tipo\ ==\ \textcolor{stringliteral}{"{}co2\_max"{}})\ maxCO2\ =\ valor;}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tipo\ ==\ \textcolor{stringliteral}{"{}luz\_min"{}})\ minLight\ =\ (int)valor;}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tipo\ ==\ \textcolor{stringliteral}{"{}voltaje\_min"{}})\ minVoltage\ =\ valor;}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tipo\ ==\ \textcolor{stringliteral}{"{}rssi\_min"{}})\ minRSSI\ =\ (int)valor;}
\DoxyCodeLine{00306\ \ \ \ \ \}}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00314\ \ \ \ \ String\ \mbox{\hyperlink{class_thresholds_af201ffee6ff0ee5b81a16147cd1a2222}{formatSensorData}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_sensor_data}{SensorData}}\&\ d)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ String\ msg\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🌡️\ Temp:\ "{}}\ +\ String(d.temperature,\ 1)\ +\ \textcolor{stringliteral}{"{}\ °C\(\backslash\)n"{}};}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}💧\ Hum:\ "{}}\ +\ String(d.humidity,\ 1)\ +\ \textcolor{stringliteral}{"{}\ \%\(\backslash\)n"{}};}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}☀️\ Luz:\ "{}}\ +\ String(d.light)\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🫁\ CO2:\ "{}}\ +\ String(d.co2ppm)\ +\ \textcolor{stringliteral}{"{}\ ppm\(\backslash\)n"{}};}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🌱\ Suelo:\ "{}}\ +\ String(d.soilMoisture,\ 1)\ +\ \textcolor{stringliteral}{"{}\ \%\(\backslash\)n"{}};}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}🔋\ Volt:\ "{}}\ +\ String(d.voltage,\ 2)\ +\ \textcolor{stringliteral}{"{}\ V\(\backslash\)n"{}};}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ msg\ +=\ \textcolor{stringliteral}{"{}📶\ RSSI\ WiFi:\ "{}}\ +\ String(\mbox{\hyperlink{class_thresholds_a90fd4587dea399f567a7c5402be09da7}{RSSIWiFi}})\ +\ \textcolor{stringliteral}{"{}\ dBm\(\backslash\)n"{}};}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ msg;}
\DoxyCodeLine{00324\ \ \ \ \ \}}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00332\ \ \ \ \ String\ \mbox{\hyperlink{class_thresholds_a751cb3228c8aab50f56f0561516cd44a}{formatActuatorState}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_actuator_state}{ActuatorState}}\&\ state)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ String\ s\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ s\ +=\ \textcolor{stringliteral}{"{}💧\ Bomba:\ "{}}\ +\ String(state.\mbox{\hyperlink{struct_actuator_state_a2e6e71e1b72f5f7df11eb03a1b48b99e}{waterPump}}\ ?\ \textcolor{stringliteral}{"{}ON"{}}\ :\ \textcolor{stringliteral}{"{}OFF"{}})\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ s\ +=\ \textcolor{stringliteral}{"{}🌀\ Ventilador:\ "{}}\ +\ String(state.\mbox{\hyperlink{struct_actuator_state_a1cfe9ff4489556ce5b58d5a30a42f1ca}{fan}}\ ?\ \textcolor{stringliteral}{"{}ON"{}}\ :\ \textcolor{stringliteral}{"{}OFF"{}})\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ s\ +=\ \textcolor{stringliteral}{"{}💡\ LEDs:\ "{}}\ +\ String(state.\mbox{\hyperlink{struct_actuator_state_ab1f44635e84e731fcc0aae40c678a9ef}{leds}}\ ?\ \textcolor{stringliteral}{"{}ON"{}}\ :\ \textcolor{stringliteral}{"{}OFF"{}});}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ s;}
\DoxyCodeLine{00338\ \ \ \ \ \}}
\DoxyCodeLine{00339\ \};}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
